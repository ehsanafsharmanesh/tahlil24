<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù¾Ù†Ù„ Ù…Ø·Ø§Ù„Ø¹Ø§ØªÛŒ Ø¢Ú©Ø§Ø¯Ù…ÛŒ</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.rtl.min.css" rel="stylesheet">
    <style>
        body { background-color: #f0f2f5; font-family: 'Tahoma', sans-serif; }
        .exam-banner { background: linear-gradient(45deg, #ff4b2b, #ff416c); color: white; padding: 15px; border-radius: 15px; margin-bottom: 20px; animation: pulse 2s infinite; }
        @keyframes pulse { 0% {transform: scale(1);} 50% {transform: scale(1.02);} 100% {transform: scale(1);} }
        .plan-card { background: white; border-radius: 12px; padding: 15px; margin-bottom: 10px; border-right: 6px solid #007bff; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .stamp-box { display: none; text-align: left; margin-top: 20px; }
        @media print {
            .no-print { display: none !important; }
            .stamp-box { display: block !important; }
            body { background: white; }
        }
    </style>
</head>
<body>
    <div class="container py-4 no-print">
        <h3 class="text-center mb-4 text-primary">Ø¢Ú©Ø§Ø¯Ù…ÛŒ Ø¯Ú©ØªØ± Ø§ÙØ´Ø§Ø±Ù…Ù†Ø´</h3>
        
        <div id="exam-container"></div>

        <div class="card p-3 mb-4 shadow-sm">
            <label class="form-label">Ø§Ù†ØªØ®Ø§Ø¨ ØªØ§Ø±ÛŒØ® Ú¯Ø²Ø§Ø±Ø´:</label>
            <input type="text" id="dateInput" class="form-control text-center" placeholder="Ù…Ø«Ù„Ø§Ù‹ Û±Û´Û°Û´/Û±Û°/Û°Û¹" onchange="fetchData()">
        </div>

        <div id="plan-list">
            </div>

        <button class="btn btn-success w-100 mt-4 py-3 fw-bold" onclick="window.print()">ğŸ–¨ï¸ Ú†Ø§Ù¾ Ø¨Ø±Ù†Ø§Ù…Ù‡ Ø§ÛŒÙ† Ù‡ÙØªÙ‡</button>
    </div>

    <div class="stamp-box">
        <div style="border-top: 2px solid #333; padding-top: 10px; display: flex; justify-content: space-between;">
            <div><p id="print-quote" style="font-style: italic;"></p></div>
            <div>
                <img src="https://drive.google.com/thumbnail?id=1yD5HwxYqRXZUdiYrlHg_fM-SVvZC_1yB&sz=w300" alt="Ù…Ù‡Ø± Ø¯Ú©ØªØ± Ø§ÙØ´Ø§Ø±Ù…Ù†Ø´" style="width: 150px;">
                <p class="text-center">ØªØ§ÛŒÛŒØ¯ Ù…Ø´Ø§ÙˆØ±</p>
            </div>
        </div>
    </div>

    <script>
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyyJaeaBi301y227SSIEzoWO9G9MqJXSKfesvVca2vh7vsf207NRmLxxXCOkn-PaACf/exec";
        const studentCode = "tahsili38"; // Ø§ÛŒÙ† Ø±Ø§ Ø§Ø² Ù„Ø§Ú¯ÛŒÙ† Ù…ÛŒâ€ŒÚ¯ÛŒØ±ÛŒØ¯

        async function fetchData() {
            const date = document.getElementById('dateInput').value;
            if(!date) return;
            
            const response = await fetch(SCRIPT_URL, {
                method: 'POST',
                body: JSON.stringify({ action: "getDayPlan", studentCode: studentCode, date: date })
            });
            const data = await response.json();

            if(data.status === "success") {
                // Ù†Ù…Ø§ÛŒØ´ Ø¢Ø²Ù…ÙˆÙ†
                if(data.exam) {
                    document.getElementById('exam-container').innerHTML = `
                        <div class="exam-banner shadow">
                            <strong>ğŸ“¢ ØªÙˆØ¬Ù‡:</strong> Ø§Ù…Ø±ÙˆØ² ${data.exam} Ø¯Ø§Ø±ÛŒ!
                        </div>`;
                } else {
                    document.getElementById('exam-container').innerHTML = "";
                }

                // Ù†Ù…Ø§ÛŒØ´ Ø¯Ø±ÙˆØ³
                let html = "";
                data.plan.forEach(item => {
                    html += `
                        <div class="plan-card">
                            <div><small class="text-muted">${item.time}</small><br><strong>${item.lesson}</strong></div>
                            <input type="checkbox" class="form-check-input" style="width:25px; height:25px">
                        </div>`;
                });
                document.getElementById('plan-list').innerHTML = html;
                document.getElementById('print-quote').innerText = data.quote;
            } else {
                alert("Ø¨Ø±Ù†Ø§Ù…Ù‡â€ŒØ§ÛŒ Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ† ØªØ§Ø±ÛŒØ® ÛŒØ§ÙØª Ù†Ø´Ø¯.");
            }
        }
    </script>
</body>
</html>
